{"name":"Duranius-paypal-rest-api-php-library","tagline":"If you need to integrate your website with PayPal REST API, then all you need is to download this library and you are ready to go. There are only two files you need to download and import to your project.","body":"paypal-rest-api-php-library\r\n===========================\r\n\r\nIf you need to integrate your website with PayPal REST API, then all you need is to download this library and you are ready to go. There are only two files you need to download and import to your project.\r\n\r\n# How to install\r\n\r\n##Step 1\r\n\r\nIn the folder called *library* you will find two files\r\n\r\n1. `DPayPal.php` \r\n2. `cacert.pem`\r\n \r\nCopy both files in your project folder, and reference file `DPayPal.php` using `require_once` php command\r\n\r\n`require_once \"DPayPal.php\"`\r\n\r\n\r\nPlease make sure that both files `DPayPal.php` and `cacert.pem` are located in the same folder. \r\n\r\n\r\n\r\nIf you want to keep the files `DPayPal.php` and `cacert.pem` in the different folders, then open the file `DPayPal.php` and edit the following line\r\n\r\nfrom `CURLOPT_CAINFO => dirname(__FILE__) . '/cacert.pem', //CA cert file`\r\n\r\nto `CURLOPT_CAINFO => \"PATH TO YOUR cacert.pem file\"`\r\n\r\n##Step 2\r\n\r\nPlease enter your PayPal API credentials in the `DPayPal.php` file\r\n\r\n`protected $username = \"\"; //PayPal API username`\r\n\r\n`protected $password = \"\"; //PayPal API password`\r\n\r\n`protected $apiSignature = \"\"; //PayPal API signature`\r\n\r\n##Step 3\r\n\r\nSet your PayPal working environment. Open `DPayPal.php` and set PayPal API URL:\r\n\r\nIf you are going to work with live PayPal API then use the following URL: **https://api-3t.paypal.com/nvp**\r\n\r\nIf you are going to work with test PayPal API (sandbox) then use the following URL: **https://api-3t.sandbox.paypal.com/nvp**\r\n\r\nFor example, if you want to work with Sandbox API set attribute `$payPalAPIUrl` located in `DPayPal.php` file to the `https://api-3t.sandbox.paypal.com/nvp` like it is demonstrated below:\r\n\r\n`protected $payPalAPIUrl = \"https://api-3t.sandbox.paypal.com/nvp\";`\r\n\r\n#How to use the library\r\n\r\nAnywhere in your code create `DPayPal` object:\r\n\r\n```\r\nrequire_once 'DPayPal.php'; //Import library\r\n$paypal = new DPayPal(); //Create an object\r\n\r\n```\r\nNow if you want to call `SetExpressCheckout` PayPal API operation, just call `SetExpressCheckout` on the `$paypal` object like it is demonstrated here:\r\n\r\n`$response = $paypal->SetExpressCheckout($requestParams);`\r\n\r\nwhere `$requestParams` is array which contains `key=>value` pairs, and `$response` is response object received by PayPal.\r\n\r\n###Advanced example: \r\n\r\n**IMPORTANT** - Before we proceed with an example, please have a look at this PayPal payment flow in order to understand how things are working: https://www.paypalobjects.com/webstatic/en_US/developer/docs/ec/sandboxEC.gif\r\n\r\nThis example explains how to obtain TOKEN from Paypal (steps 1, 2 and 3 from the image above):\r\n\r\n```\r\n$paypal = new DPayPal(); //Create an object\r\n\r\n//Generating request parameters for API operation SetExpressCheckout\r\n//All available parameters for this method are available here\r\n//https://developer.paypal.com/docs/classic/api/merchant/SetExpressCheckout_API_Operation_NVP/\r\n\r\n$requestParams = array(\r\n    'RETURNURL' => \"\", //Enter your webiste URL here\r\n    'CANCELURL' => \"\"//Enter your website URL here\r\n);\r\n\r\n$orderParams = array(\r\n    'LOGOIMG' => \"\", //You can paste here your website logo image which will be displayed to the customer on the PayPal chechout page\r\n    \"MAXAMT\" => \"100\", //Set max transaction amount\r\n    \"NOSHIPPING\" => \"1\", //I do not want shipping\r\n    \"ALLOWNOTE\" => \"0\", //I do not want to allow notes\r\n    \"BRANDNAME\" => \"Here enter your brand name\",\r\n    \"GIFTRECEIPTENABLE\" => \"0\",\r\n    \"GIFTMESSAGEENABLE\" => \"0\"\r\n);\r\n$item = array(\r\n    'PAYMENTREQUEST_0_AMT' => \"20\",\r\n    'PAYMENTREQUEST_0_CURRENCYCODE' => 'GBP',\r\n    'PAYMENTREQUEST_0_ITEMAMT' => \"20\",\r\n    'L_PAYMENTREQUEST_0_NAME0' => 'Item name',\r\n    'L_PAYMENTREQUEST_0_DESC0' => 'Item description',\r\n    'L_PAYMENTREQUEST_0_AMT0' => \"20\",\r\n    'L_PAYMENTREQUEST_0_QTY0' => '1',\r\n        //\"PAYMENTREQUEST_0_INVNUM\" => $transaction->id - This field is useful if you want to send your internal transaction ID\r\n);\r\n\r\n //Send request and wait for response\r\n //Now we will call SetExpressCheckout API operation. \r\n\r\n$response = $paypal->SetExpressCheckout($requestParams + $orderParams + $item);\r\n\r\n//Response is aslo accessible by calling  $paypal->getLastServerResponse()\r\n\r\n//Now you will be redirected to the PayPal to enter your customer data\r\n//After that, you will be returned to the RETURN URL\r\nif (is_array($response) && $response['ACK'] == 'Success') { //Request successful\r\n    //Now we have to redirect user to the PayPal\r\n    $token = $response['TOKEN'];\r\n\r\n    header('Location: https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_express-checkout&token=' . urlencode($token));\r\n} else if (is_array($response) && $response['ACK'] == 'Failure') {\r\n    var_dump($response);\r\n    exit;\r\n} \r\n\r\n```\r\n\r\n#Other notes\r\n\r\n#### To call `GetExpressCheckoutDetails` just type: \r\n\r\n```\r\n$paypal->GetExpressCheckoutDetails($requestParameters);\r\n```\r\n\r\n####To call `DoExpressCheckoutPayment` just type: \r\n\r\n```\r\n$paypal->DoExpressCheckoutPayment($requestParameters);\r\n```\r\n\r\n####To call any other PayPal API operation use method `sendRequest`. \r\n\r\nFor example let's say we want to call `CreateRecurringPaymentsProfile` API operation, then we could do it like this: \r\n\r\n```\r\n$paypal->sendRequest(\"CreateRecurringPaymentsProfile \", $requestParameters);\r\n```\r\n\r\n####To see errors just type:\r\n\r\n```\r\n$paypal->showErrors();\r\n```\r\n\r\n####To see last response from PayPal just type:\r\n\r\n```\r\n$response=$paypal->getLastServerResponse();\r\n```\r\n\r\n####You can set new credentials by calling set methods:\r\n\r\n```\r\n$paypal->setUsername(\"new username\");\r\n\r\n$paypal->setPassword(\"new pass\");\r\n\r\n$paypal->setApiSignature(\"new signature\");\r\n\r\n```\r\n\r\n####You can disable or enable error reporting by calling: \r\n\r\n```\r\n$paypal->enableErrorReporting();\r\n\r\n$paypal->disableErrorReporting();\r\n\r\n```\r\n\r\nHope I helped :)\r\n","google":"UA-58102300-1","note":"Don't delete this file! It's used internally to help with page regeneration."}